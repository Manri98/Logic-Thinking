<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" type="text/css" href="encuesta.css">
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
        <script>
            $(document).ready(function(){
                var count1 = 0;
                var count2 = 0;
                var count3 = 0;
                var total = 0;
				var comprobacion = "v";
				var newip = 0;
				var ips = new Array();
				$.get('http://jsonip.com', function (res){
					$('p1').html('Tu IP es: ' + res.ip)
					newip=res.ip;
				});
				for (var i = 0; i <= ips.length; i++){
					if (ips[i] == newip){
						comprobacion = "v";
					};
					else{
						comprobacion = "f";
					};
				};
                $("#btn1").click(function(){
					if(comprobacion = "v"){
						count1++;
						total++;
						$("#box1").animate({width: (count1/total)*100+"%"});
						$("#box2").animate({width: (count2/total)*100+"%"});
						$("#box3").animate({width: (count3/total)*100+"%"});
						document.getElementById("p1").innerHTML = Math.round((count1/total)*100)+"%";
						document.getElementById("p2").innerHTML = Math.round((count2/total)*100)+"%";
						document.getElementById("p3").innerHTML = Math.round((count3/total)*100)+"%";
						document.getElementById("marcador").innerHTML = "Punto para el 1";
						ips.push(newip);
						localStorage.setItem("Lista de IPs", ips);
					}
					else{
						document.getElementById("marcador").innerHTML = "YA HAS VOTADO";
					}
                });
                $("#btn2").click(function(){
					if(comprobacion = "v"){
						count2++;
						total++;
						$("#box1").animate({width: (count1/total)*100+"%"});
						$("#box2").animate({width: (count2/total)*100+"%"});
						$("#box3").animate({width: (count3/total)*100+"%"});
						document.getElementById("p1").innerHTML = Math.round((count1/total)*100)+"%";
						document.getElementById("p2").innerHTML = Math.round((count2/total)*100)+"%";
						document.getElementById("p3").innerHTML = Math.round((count3/total)*100)+"%";
						document.getElementById("marcador").innerHTML = "Punto para el 2";
						ips.push(newip);
						localStorage.setItem("Lista de IPs", ips);
					}
					else{
						document.getElementById("marcador").innerHTML = "YA HAS VOTADO";
					}
                });
                $("#btn3").click(function(){
					if(comprobacion = "v"){
						count3++;
						total++;
						$("#box1").animate({width: (count1/total)*100+"%"});
						$("#box2").animate({width: (count2/total)*100+"%"});
						$("#box3").animate({width: (count3/total)*100+"%"});
						document.getElementById("p1").innerHTML = Math.round((count1/total)*100)+"%";
						document.getElementById("p2").innerHTML = Math.round((count2/total)*100)+"%";
						document.getElementById("p3").innerHTML = Math.round((count3/total)*100)+"%";
						document.getElementById("marcador").innerHTML = "Punto para el 3";
						ips.push(newip);
						localStorage.setItem("Lista de IPs", ips);
					}
					else{
						document.getElementById("marcador").innerHTML = "YA HAS VOTADO";
					}
                });
				document.getElementById("marcador").innerHTML = localStorage.getItem("Lista de IPs");
			});
        </script>
    </head>
	<body>
	<div class="divcl">
        <div id="box1" class="box1">
            <p id="p1">
		</div>
        <div id="box2" class="box2">
            <p id="p2">
		</div>
        <div id="box3" class="box3">
            <p id="p3">
		</div>
        <button id="btn1" class="btn1">Voto 1</button>
        <button id="btn2" class="btn2">Voto 2</button>
        <button id="btn3" class="btn3">Voto 3</button>
	</div>
	<div class="divcl">
		<hr>
		<h1>MARCADOR</h1>
		<hr>
		<p id="marcador"></p>
		<p1></p1>
	</div>
    </body>
</html>